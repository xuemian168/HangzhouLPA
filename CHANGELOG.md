# 更新日志

本文档记录项目的所有重要更改。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [Unreleased]

## [1.1.2] - 2025-12-18

### 修复 🐛
- 🔧 **关键修复**: 修复无限翻页 bug，正确使用 API 分页参数 `paramJson`
- 修复翻页逻辑错误，从错误的 `pageNum` 参数改为 `{"pageNo":N,"pageSize":"15"}` 格式
- 修复 GitHub Actions 工作流中的标签引用错误

### 新增 ✨
- 添加自动翻页功能，确保获取所有页面的项目数据（当前共 46 个项目，4 页）
- 程序运行完成后自动打开 https://www.ict.run

### 改进 🚀
- 优化分页逻辑，通过 URL 去重机制自动检测并停止翻页
- 添加每页项目数量统计和进度显示
- 显示总项目数和总页数
- 移除不必要的连续重复检测和页数限制

## [1.1.1] - (已跳过)

## [1.0.0] - 2025-12-18

### 新增 ✨
- 完全重构代码，采用面向对象设计
- 遵循 SOLID、DRY、KISS、YAGNI 原则
- 添加类型注解提升代码质量
- 支持多平台自动构建发布（Windows, macOS, Linux）
- 添加 GitHub Actions CI/CD 自动发布流程
- 添加本地构建脚本（build.sh 和 build.bat）
- 完善项目文档（README、RELEASE、CHANGELOG）

### 修复 🐛
- 适配新版杭州市规划和自然资源局网站
- 修复原爬虫无法工作的问题
- 使用新的 API 接口替代原有的静态页面解析
- 优化代理配置，解决网络超时问题

### 改进 🚀
- 统一的 HTTP 请求管理（HttpClient 类）
- 模块化的代码结构，提升可维护性
- 更好的错误处理和用户反馈
- 优化文件命名，避免非法字符
- 添加请求限流，避免频繁请求

### 技术细节 🔧
- **架构**:
  - Config: 配置管理
  - HttpClient: HTTP 请求封装
  - ProjectParser: HTML/JSON 解析
  - ProjectScraper: 爬取流程协调
  - ImageDownloader: 图片下载
  - CSVExporter: 数据导出
  - Application: 应用主控制器

- **依赖**:
  - requests >= 2.31.0
  - urllib3 >= 2.1.0

- **构建工具**:
  - PyInstaller (用于打包可执行文件)
  - GitHub Actions (用于自动化构建和发布)

### 破坏性变更 ⚠️
- 完全重写代码，不兼容旧版本
- API 和数据结构发生变化
- 移除旧版本的临时文件生成逻辑

## [0.1.0] - 历史版本

### 功能
- 基础的项目列表获取
- 设计图下载
- CSV 数据导出

### 已知问题
- 网站改版后无法正常工作
- 代码结构复杂，难以维护
- 缺少错误处理
- 不支持多平台发布

---

## 版本说明

### 版本号规则
- **主版本号 (MAJOR)**: 不兼容的 API 修改
- **次版本号 (MINOR)**: 向下兼容的功能性新增
- **修订号 (PATCH)**: 向下兼容的问题修正

### 图例
- ✨ 新增功能
- 🐛 Bug 修复
- 🚀 性能改进
- 📝 文档更新
- 🔧 技术优化
- ⚠️ 破坏性变更
- 🗑️ 废弃功能
